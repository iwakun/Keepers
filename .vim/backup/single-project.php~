<?php get_header(); ?>
	<main id="single-project" role="main">
		<?php
			//Variables
			$mainImage = get_field('main_image');
			$description = get_field('short_description');
			$pSize = get_field('project_size');
			$pLocation = get_field('project_location');
			$pDuration = get_field('project_duration');
		?>
		<div class="container-fluid">
			<div class="headline">
				<div class="row">
					<div 
						class="col col-md-8 main-image"
						style="background-image: url(<?= $mainImage['url']; ?>)"
						data-component="match-height">
					</div>
					<div class="col col-md-4">
						<div class="headline-content">
							<h2><?php the_title(); ?></h2>
							<hr class="blue" />
							<div class="text">
								<?= $description; ?>
							</div>
							<div class="icons">
								<div class="row">
									<div class="col-md-6 col-sm-6">
										<img src="<?php echo get_template_directory_uri(); ?>/images/icon-size.png" />
										<h3>PROJECT SIZE</h3>
										<p><?= $pSize; ?></p>
									</div>
									<div class="col-md-6 col-sm-6">
										<img src="<?php echo get_template_directory_uri(); ?>/images/icon-location.png" />
										<h3>PROJECT LOCATION</h3>
										<p><?= $pLocation; ?></p>
									</div>
								</div>
								<div class="row">
									<div class="col-md-6 col-md-offset-3">
										<img src="<?php echo get_template_directory_uri(); ?>/images/icon-duration.png" />
										<h3>PROJECT DURATION</h3>
										<p><?= $pDuration; ?></p>
									</div>
								</div>
							</div>
						</div>
						<div class="footer-social">
							<ul>
								<li>
									<a
										href="https://www.facebook.com/sharer/sharer.php?u=<?= urlencode(get_permalink()) ?>"
										class="social facebook">
									</a>
								</li>
								<li>
									<a 
										href="https://twitter.com/home?status=<?= urlencode(get_permalink()) ?>"
										class="social twitter">
									</a>
								</li>
								<li class="last">
									<a 
										href="https://pinterest.com/pin/create/button/?url=<?= urlencode(get_permalink()) ?>"
										class="social pinterest">
									</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="modules">
				<?php while( have_rows('page_modules') ) : the_row(); ?>
					<?php if( get_row_layout() == 'module_one' ) : ?>
						<?php
							//Variables
							$imageLeft = get_sub_field('bottom_left_image');
							$imageRight = get_sub_field('right_image');
							$content = get_sub_field('content_block');
						?>
						<div class="module module-one">
							<div class="row">
								<div 
									style="background-image: url(<?= $imageLeft['url'] ?>)"
									data-component="image-padding"
									data-ip-image="<?= $imageLeft['url'] ?>"
									data-ip-dir="bottom"
									class="col col-md-4 col-sm-12 content-image">
									<div class="content">
										<?= $content; ?>
									</div>
								</div>
								<div 
									class="col col-md-8 col-sm-12 main-image"
									style="background-image: url(<?= $imageRight['url']; ?>);"
									data-component="match-height">
								</div>
							</div>
						</div>
					<?php endif; ?>
					<?php if( get_row_layout() == 'module_two' ) : ?>
						<?php
							//Variables
							$title = get_sub_field('title');
							$background = get_sub_field('background_image');
						?>
						<div 
							class="module module-two" 
							style="background-image: url(<?= $background['url']; ?>);">
							<div class="row">
								<div class="col-md-12 no-gutter">
									<div class="mask">
										<h2>
											<span><?= $title; ?></span>
										</h2>
									</div>
								</div>
							</div>
						</div>
					<?php endif; ?>
					<?php if( get_row_layout() == 'module_three' ) : ?>
						<?php
							//Variables
							$imageLeft = get_sub_field('left_image');
							$imageRight = get_sub_field('top_right_image');
							$content = get_sub_field('content_block');
						?>
						<div class="module module-three">
							<div class="row">
								<div 
									class="col col-md-6 col-sm-12 main-image"
									style="background-image: url(<?= $imageLeft['url']; ?>);"
									data-component="match-height">
								</div>
								<div 
									style="background-image: url(<?= $imageRight['url'] ?>)"
									data-component="image-padding"
									data-ip-image="<?= $imageRight['url'] ?>"
									data-ip-dir="top"
									class="col col-md-6 col-sm-12 content-image">
									<div class="content">
										<?= $content; ?>
									</div>
								</div>
							</div>
						</div>
					<?php endif; ?>
					<?php if( get_row_layout() == 'module_four' ) : ?>
						<div class="module module-four">
							<ul class="project-slider">
							<?php $count = 1; ?>
							<?php while(have_rows('image_gallery')) : the_row(); ?>
								<li class="item">
									<img src="<?php $image = get_sub_field('image'); echo $image['url']; ?>" />
								</li>
							<?php endwhile; ?>
							</ul>
						</div>
					<?php endif; ?>
				<?php endwhile; ?>
			</div>
			<div class="single-footer">
				<div class="button-set">
					<a href="/contact" class="btn-blue">
						Let's Build Something
					</a>
				</div>
			</div>
			<div data-component="tax-filter">
				<div class="taxo-tags" data-tf="desktop">
					<ul class="taxo-tag">
						<li>TAGS:</li>
						<?php $posttags = get_the_tags(); ?>
						<?php if($posttags): foreach($posttags as $tag): ?>
							<li class="blue" data-tf-target="<?= $tag->slug ?>">
								<?= $tag->name ?>
							</li>
						<?php endforeach; endif; ?>
					</ul>
					<div class="taxo-lists" data-tf="tax-container">
						<!--
						<?php if($posttags): foreach($posttags as $tag): ?>
							<ul data-tf-tax="<?= $tag->slug ?>">
								<?php
								$tag_query = new WP_Query(array(
									'post_type' => 'project',
									'tag' => $tag->slug,
									'posts_per_page' => -1,
									'caller_get_posts' => 1
								));
								?>
								<?php if($tag_query->have_posts()): ?>
									<?php while($tag_query->have_posts()): $tag_query->the_post(); ?>
										<?php $image = get_field('thumbnail_image') ?>
										<li>
											<a href="<?php the_permalink() ?>">
												<img src="<?= $image['sizes']['thumbnail']; ?>" />
											</a>
										</li>
									<?php endwhile; ?>
								<?php endif; ?>
							</ul>
						<?php endforeach; endif; ?>
						-->
						<ul class="utah" data-tf-tax="utah">
							<?php
							$tag_query = new WP_Query(array(
								'post_type' => 'project',
								'tag' => 'utah',
								'posts_per_page' => -1,
								'caller_get_posts' => 1
							));
							for($i = 0; $i < 10; $i++) {
								if( $tag_query->have_posts() ) {
									while ($tag_query->have_posts()) : $tag_query->the_post(); ?>
										<li>
											<a href="<?php the_permalink() ?>">
											<img src="<?php $image = get_field('thumbnail_image'); echo $image['sizes']['thumbnail']; ?>" />
											</a>
										</li>
									 <?php
									endwhile;
								}
							}
							?>
						</ul>
						<ul class="stone" data-tf-tax="stone">
							<?php
							$args=array(
								'post_type' => 'project',
								'tag' => 'stone',
								'posts_per_page' => -1,
								'caller_get_posts' => 1
							);
							$tag_query = new WP_Query($args);
							if( $tag_query->have_posts() ) {
								while ($tag_query->have_posts()) : $tag_query->the_post(); ?>
									<a href="<?php the_permalink() ?>">
										<img src="<?php $image = get_field('thumbnail_image'); echo $image['sizes']['thumbnail']; ?>" />
									</a>
								 <?php
								endwhile;
							}
							?>
						</ul>
						<div class="controls">
							<button class="prev" data-tf="left"></button>
							<button class="next" data-tf="right"></button>
							<button class="exit" data-tf="close"></button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>
<?php get_footer(); ?>
